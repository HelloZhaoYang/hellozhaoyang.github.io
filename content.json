{"meta":{"title":"ZhaoYang's Blog","subtitle":null,"description":null,"author":"ZhaoYang","url":"http://hellozhaoyang.github.io","root":"/"},"pages":[{"title":"About","date":"2019-07-01T13:11:09.000Z","updated":"2019-07-01T15:50:34.985Z","comments":true,"path":"about/index.html","permalink":"http://hellozhaoyang.github.io/about/index.html","excerpt":"","text":"关于我从事数据库与GIS开发，主要开发语言 JAVA、Python3，熟悉使用 Oracle、PostgreSQL 等主流数据库；喜欢做些数据整合及分析。 对服务端、前端、数据分析等技能有所了解。 热爱开源项目、热爱新技术、热爱新事物。 关于工作城市：北京 关于学习正在往终身学习者前进…近期学习方向：Python (人工智能)，经济学 关于座右铭 澹泊以明志，宁静以致远 关于爱好热爱运动，尤其喜爱跑步、阅读、数学。 联系我 Blog: ZhaoYang’s Blog Email: 1004145117@cugb.edu.cn GitHub: HelloZhaoYang WeiBo: 燕山潮白河"}],"posts":[{"title":"Redis集群创建","slug":"T20190702","date":"2019-07-02T04:42:26.000Z","updated":"2020-02-19T02:42:59.723Z","comments":true,"path":"2019/07/02/T20190702/","link":"","permalink":"http://hellozhaoyang.github.io/2019/07/02/T20190702/","excerpt":"由于参与项目的部分功能需要，尝试在内网环境搭建了一Redis集群。安装环境为利用3台CentOS7.5服务器，服务器间可以相互通信。本文利用这3台服务器建设了一6节点的Redis集群，现将创建过程做一简要记录。","text":"由于参与项目的部分功能需要，尝试在内网环境搭建了一Redis集群。安装环境为利用3台CentOS7.5服务器，服务器间可以相互通信。本文利用这3台服务器建设了一6节点的Redis集群，现将创建过程做一简要记录。 1.环境准备1.1 软件环境及版本 软件名称 版本 CentOS(操作系统) 7.5.1804 Redis 5.0.0 Ruby 2.5.3 Rubygems 2.7.8 Redis.gem 4.0.3 1.2演示服务器IP地址 IP地址 172.16.100.249172.16.100.250172.16.100.251 1.2 防火墙设置若部署环境允许操作系统关闭防火墙，只需在操作系统层面对每台服务器关闭防火墙即可。shell命令为 1systemctl stop firewalld.service 之后可利用shell命令检查防火墙状态 1systemctl status firewalld.service 关闭防火墙后，执行命令 1systemctl disable firewalld.service 关闭防火墙开机自起。 但是，生产环境大多不允许操作系统裸奔，需要运维人员开启操作系统防火墙。因此，我们部署Redis集群时，还需要手动开放一些端口。 首先我们需要确定Redis各节点部署在哪些端口上。这里我们选择三台服务器的6379及6380端口作为我们的部署端口。此外，Redis还需要部署端口数值加10000作为通信及集群管理使用。对本例而言即还需开放三台服务器的16379及16380端口。综上，添加防火墙端口的shell命令为： 1234firewall-cmd --zone=public --add-port=6379/tcp –-permanentfirewall-cmd --zone=public --add-port=16379/tcp --permanentfirewall-cmd --zone=public --add-port=6380/tcp --permanentfirewall-cmd --zone=public --add-port=16380/tcp --permanent 最后我们重新加载一下防火墙： 1firewall-cmd --reload 1.3 yum本地源配置若部署环境可连接互联网或有局域网内有yum镜像源，按所选的源镜像配置即可；这里我们在本地局域网进行部署，不能连接互联网，局域网内也没有可用的yum源镜像，因此需要使用操作系统的安装盘或镜像文件配置本地yum源。利用scp等工具，先将CentOS7的安装盘的镜像文件上传到服务器上，并在/mnt目录下创建CentOS文件夹作为镜像盘的挂载位置。 1mkdir /mnt/CentOS 之后挂载镜像光盘 1mount -t iso9660 -o loop CentOS-7-x86_64-DVD-1804.iso /mnt/CentOS/ ISO镜像挂载好后，我们开始配置yum本地源。先备份原yum源配置 12cd /etc/yum.repo.dmv CentOS-Base.repo CentOS-Base.repo.bak 之后创建本地源的配置文件 1vi CentOS-LocalSource.repo 键盘输入i开始编辑，配置内容如下所示： [CentOS-LocalSource]name=CentOSbaseurl=file:///mnt/CentOSenable=1gpgcheck=0 编辑好后，按ESC键退出插入模式后输入:wq保存退出。清除yum的本地缓存，并建立新缓存 12yum clean allyum makecache 利用yum安装gcc及make等创建Redis需要依赖测试本地yum源是否配置成功 1234yum install gccyum install makeyum install zlibyum install openssl 2.安装单机Redis利用scp等工具，先将redis的安装文件上传到服务器上。创建Redis的安装目录 1mkdir /usr/local/redis 将Redis的安装文件解压到安装目录 1tar -zxvf redis-5.0.0.tar.gz -C /usr/local/redis 进入到Redis安装文件的解压目录 1cd /usr/local/redis/redis-5.0.0/ 利用make进行安装 1make PREFIX=/usr/local/redis install 3.ruby及rubygems3.1安装ruby先将ruby、rubygems、redis.gem等文件上传到服务器上.创建ruby及ruby的安装目录，并将安装包解压到安装目录中 1234mkdir /usr/local/rubytar -zxvf ruby-2.5.3.tar.gz -C /usr/local/ruby/mkdir /usr/local/rubygemstar -zxvf rubygems-2.7.8.tgz -C /usr/local/rubygems/ 先make安装ruby 1234cd /usr/local/ruby/ruby-2.5.3./configure --prefix=/usr/local/rubymakemake install 安装完后测试ruby是否添加到环境变量中 1ruby -v 若返回结果如下，说明ruby为注册到环境变量中，需要手动添加利用vi编辑器打开/etc/profile文件，键盘按i开始编辑，按shift+g调到文件末尾，新起一行，将ruby所在文件夹地址添加到PATH环境变量中 export PATH=$PATH:/usr/local/ruby/bin 键盘按ESC推出编辑模式后输入:wq保存退出。在shell命令行中,输入 1source /etc/profile 使环境变量立即生效。此时输入ruby -v发现ruby已经注册到系统的环境变量中。 3.2安装rubygems及redis.gem进入到rubygems安装包解压目录，安装rubygems 12cd /usr/local/rubygems/rubygems-2.7.8ruby setup.rb 安装完成后，在shell命令行中输入 1gem -v 查看rubygems是否安装成功若返回结果为 则说明rubygems已经安装成功。下面安装redis.gem利用cd命令进入到redis-4.0.3.gem所在文件夹在shell命令行中输入 1gem install redis-4.0.3.gem 即可完成redis-4.0.3.gem的安装。 4.创建Redis集群先在每台服务器上创建Redis的配置文件目录，并将Redis自带的配置文件拷贝到配置文件目录中 123cd /usr/local/redismkdir confcp redis-5.0.0/redis.conf conf/ 利用端口号命名Redis的配置文件 1mv conf/redis.conf conf/redis-6379.conf 修改相应配置以进行集群搭建,我们先对6379端口的配置进行修改。由于6379是Redis的默认端口，因此关于端口方面的配置不需要修改。 1vi conf/redis.conf daemonized yespidfile /var/run/redis_6379.pidlogfile “node-6379.log”cluster-enabled yescluster-node-timeout 15000cluster-config-file nodes-6379.confbind 172.16.100.249 127.0.0.1 更改完后按:wq保存将6379端口配置文件复制一份，作为6380端口的配置文件，并进行编辑。 12cp conf/redis-6379.conf conf/redis-6380.confvi conf/redis-6380.conf 这里我们利用vi编辑器命令:%s/6379/6380/g将文件中所有出现6379的地方替换为6380后，输入:wq保存退出。配置文件更改好后，启动redis节点 12./bin/redis-server ./conf/redis-6379.conf./bin/redis-server ./conf/redis-6380.conf 之后我们在shell命令行中查看后台进程是运行 1ps -aux |grep redis 若返回结果如下，说明redis后台进程已正常运行。同理，我们对另外两台服务器也进行相应配置，但注意配置文件中bind要替换为对应的服务器IP，配置文件更改好后，同理仿照上步启动节点。当三台服务器6个节点均启动后，我们开始创建Redis集群。选择其中一台服务器(以下测试步骤选择任意一台服务器操作即可),执行 1./bin/redis-cli --cluster create 172.16.100.251:6380 172.16.100.250:6379 172.16.100.250:6380 172.16.100.249:6379 172.16.100.249:6380 172.16.100.251:6379 --cluster-replicas 1 弹出下面对话后输入yes继续 再等一会，发现Redis集群已经创建成功。 利用show_redis_map工具可以查看Redis各节点的情况。将show_redis_map的shell脚本上传到服务器后，运行 1chmod a+x show_redis_map.sh 给予show_redis_map.sh可执行权限之后再将redis-cli所在目录注册到环境变量中 12cd ~vi .bash_profile 在文件结尾处添加 export PATH=$PATH:/usr/local/redis/bin 1source .bash_profile 使用户的环境变量生效。最后进入到show_redis_map.sh所在目录执行 1./show_redis_map.sh 127.0.0.1:6379 即可查看Redis各节点存活情况及Redis集群master和slave的映射关系。 5.为集群创建密码由于Redis不设置密码十分危险，故在生产环境中一般要求Redis设置连接密码。由于我们是搭建的Redis集群服务器，需要在每台部署服务器的每个端口均需要设置一次连接密码，这里我们以6379端口设置连接密码为123456为例，命令如下： 12cd /usr/local/redis./bin/redis-cli -c -p 6379 在Redis命令行中，执行 123config set masterauth 123456config set requirepass 123456config rewrite 在其它各连接节点都需要重复执行这一操作，注意各个节点的密码都必须一致，否则Redirected就会失败。","categories":[{"name":"计算机","slug":"计算机","permalink":"http://hellozhaoyang.github.io/categories/计算机/"}],"tags":[{"name":"NoSQL","slug":"NoSQL","permalink":"http://hellozhaoyang.github.io/tags/NoSQL/"},{"name":"Redis","slug":"Redis","permalink":"http://hellozhaoyang.github.io/tags/Redis/"}]},{"title":"经济学十大原理","slug":"T20190701","date":"2019-07-01T15:26:17.631Z","updated":"2019-07-01T15:42:19.778Z","comments":true,"path":"2019/07/01/T20190701/","link":"","permalink":"http://hellozhaoyang.github.io/2019/07/01/T20190701/","excerpt":"最近结合清华大学钱颖一教授与钟笑寒教授在爱课程上的视频共享课学习曼昆的《经济学原理》一书，有颇多感触。现仅将导言部分所介绍之经济学十大原理部分简单归纳。","text":"最近结合清华大学钱颖一教授与钟笑寒教授在爱课程上的视频共享课学习曼昆的《经济学原理》一书，有颇多感触。现仅将导言部分所介绍之经济学十大原理部分简单归纳。 人们如何做出决策How People Make Decisions 1.人们面临得失交换People Face Tradeoff。 2.某物的成本是为此所放弃的东西The Cost Of Something Is What You Give Up To Get It. 机会成本：为了得到它而放弃的东西。 取决于你面临的其他选择 某些机会成本容易被忽视 3.理性人思考边际量Rational People Think At The Margin. 4.人们会对激励做出反应People Respond To Incentives. 人们如何相互作用How People Interact 5.贸易能使人人受益Trade Can Make Everyone Better Off. People gain from their ability to trade with one other. Competition results in gains from trading. Trade allows people to specialize in what they do best. 6.市场通常是组织经济活动的好方式Markets Are Usually A Good Way To Organize Economic Activity. 家庭决定买什么及为谁工作 企业决定雇佣谁及生产什么 7.政府有时可以改进市场结果Governments Can Sometimes Improve Market Outcomes. 市场失灵(Market Failure):当市场不能有效率地配置资源时，市场失灵发生 外部性(Externality):某人或某企业的行为对旁人利益造成的影响 市场势力(Market Power):个人或企业不适当地影响市场价格的能力 整体经济如何运行How The Economy As a Whole Work 8.一国的生活水平取决于它的生产The Standard Of Living Depends On A Country’s Production. 生产率(Productivities)一般指单位设备（如一台机床或一条自动生产线）或设备的单位容量（如高炉的每立方米容积），在单位时间(如一小时、一昼夜)内出产的合格产品的数量。如果指每个工人在单位时间内生产的合格产品数量，则称为劳动生产率，它是衡量生产技术的先进性、生产组织的合理性和工人劳动的积极性的指标之一。 9.当政府发行过多货币时，物价上升Prices Rise When The Government Prints Too Much Money. 通货膨胀(Inflation)是经济中整体物价水平的上升 10.社会面临通货膨胀与失业之间的短期得失交换Society Faces A Short-run Tradeoff Between inflation and unemployment.","categories":[{"name":"经济学","slug":"经济学","permalink":"http://hellozhaoyang.github.io/categories/经济学/"}],"tags":[{"name":"经济学原理","slug":"经济学原理","permalink":"http://hellozhaoyang.github.io/tags/经济学原理/"},{"name":"曼昆","slug":"曼昆","permalink":"http://hellozhaoyang.github.io/tags/曼昆/"}]}]}